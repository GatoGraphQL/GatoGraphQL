name: Split Monorepo Dev-Master

on:
    pull_request: null

jobs:
    split_monorepo:
        runs-on: ubuntu-latest

        name: Monorepo Split of api-graphql (hardcoded)

        steps:
            -   uses: actions/checkout@v2
                with:
                    submodules: ${{ env.CHECKOUT_SUBMODULES }}

                # Uses an action in the root directory
            -   name: Split ${{ matrix.package.name }} (${{ matrix.package.path }})
                if: "!startsWith(github.ref, 'refs/tags/')"
                uses: leoloso/monorepo-split-github-action@issues/17
                env:
                    GITHUB_TOKEN: "WRONG-CREDENTIAL-${{ secrets.ACCESS_TOKEN }}"
                with:
                    branch: 'master'
                    package_directory: 'layers/API/packages/api-graphql'
                    repository_organization: 'getpop'
                    repository_name: 'api-graphql'
                    user_name: "leoloso"
                    user_email: "leo@getpop.org"
