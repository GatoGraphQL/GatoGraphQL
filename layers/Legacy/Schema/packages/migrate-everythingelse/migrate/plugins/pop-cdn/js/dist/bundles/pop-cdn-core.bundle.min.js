"use strict";!function(t){window.popCDN={localStorageKey:"PoP:cdn-thumbprints",thumbprintValues:{},config:{},documentInitialized:function(e){var r=this,n=e.domain,a=popManager.getTopLevelFeedback(n)[M.CDN_THUMBPRINTVALUES];r.thumbprintValues=popManager.getStoredData(r.localStorageKey,!1),r.thumbprintValues?r.updateThumbprintValues(a):(r.thumbprintValues=t.extend({},a),r.storeData())},pageSectionFetchSuccess:function(t){var e=this,r=t.response;e.fetchSuccess(r)},blockFetchSuccess:function(t){var e=this,r=t.response;e.fetchSuccess(r)},modifyFetchArgs:function(t){var e=this,r=t.options,n=t.url;if(e.useCDN(n)){t.url=e.getCDNUrl(n);var a=e.getThumbprintValue(n);a&&(r.params=r.params||{},r.params[M.CDN_URLPARAM_THUMBPRINT]=a)}},modifyFetchBlockArgs:function(t){var e=this,r=t.options,n=t.url;if("GET"==t.type&&e.useCDN(n)){t.url=e.getCDNUrl(n);var a=e.getThumbprintValue(n);a&&(r["onetime-post-data"]=r["onetime-post-data"]?r["onetime-post-data"]+"&":"",r["onetime-post-data"]+=M.CDN_URLPARAM_THUMBPRINT+"="+a)}},hasConfiguration:function(t){var e=this,r=getDomain(t);return void 0!==e.config[r]},getConfiguration:function(t){var e=this,r=getDomain(t);return e.config[r]},getThumbprints:function(e){var r=this;if(!r.hasConfiguration(e))return console.log("There is no config object, no thumbprints returned"),[];var n=r.getConfiguration(e),a=[];return t.each(n.thumbprints,function(t,i){r.evalCriteria(e,n.criteria.thumbprints[i])&&a.push(i)}),a},isHome:function(t){var e=removeParams(t);return[M.HOME_DOMAIN,M.HOME_DOMAIN+"/",M.HOMELOCALE_URL,M.HOMELOCALE_URL+"/"].indexOf(e)>-1},evalCriteria:function(e,r){var n=this,a=function(t){var r=t[0],n=t[1],a=getParam(r,e);return"object"==typeof a?searchInObject(a,n):a==n},i=[{isHome:r.isHome&&n.isHome(e),startsWith:r.startsWith.full.some(function(t){return e.startsWith(t)}),pageStartsWith:r.startsWith.partial.some(function(t){return e.startsWith(M.HOMELOCALE_URL+"/"+t)}),hasParamValues:r.hasParamValues.some(a)},{noParamValues:!r.noParamValues.some(a)}],o=0;return t.each(i,function(t,e){Object.keys(e).filter(function(t){return e[t]}).length&&o++}),o==i.length},fetchSuccess:function(t){this.updateThumbprintValues(t.feedback.toplevel[M.CDN_THUMBPRINTVALUES])},updateThumbprintValues:function(t){var e=this,r=!1;for(var n in t)t[n]>e.thumbprintValues[n]&&(e.thumbprintValues[n]=t[n],r=!0);r&&e.storeData()},storeData:function(){var t=this;popManager.storeData(t.localStorageKey,t.thumbprintValues)},useCDN:function(t){var e=this;if(!e.hasConfiguration(t))return!1;var r=e.getConfiguration(t);return!!r.cdnDomain&&!e.evalCriteria(t,r.criteria.rejected)},getCDNUrl:function(t){var e=this,r=getDomain(t);return e.getConfiguration(t).cdnDomain+t.substr(r.length)},getThumbprintValue:function(t){var e=this;return e.getThumbprints(t).map(function(t){return e.thumbprintValues[t]}).join(M.CDN_SEPARATOR_THUMBPRINT)},convertURL:function(t){var e=this;if(e.useCDN(t)){var r=e.getThumbprintValue(t);t=e.getCDNUrl(t),r&&(t=add_query_arg(M.CDN_URLPARAM_THUMBPRINT,r,t))}return t}}}(jQuery),popJSLibraryManager.register(popCDN,["documentInitialized","pageSectionFetchSuccess","blockFetchSuccess"],!0),popJSLibraryManager.register(popCDN,["modifyFetchArgs","modifyFetchBlockArgs"]);
;"use strict";jQuery,window.popCDNCoreHooks={mentionsSource:function(e){e.url=popCDN.convertURL(e.url)},typeaheadPrefetchURL:function(e){e.url=popCDN.convertURL(e.url)},typeaheadRemoteURL:function(e){e.url=popCDN.convertURL(e.url)}},popJSLibraryManager.register(popCDNCoreHooks,["mentionsSource","typeaheadPrefetchURL","typeaheadRemoteURL"]);