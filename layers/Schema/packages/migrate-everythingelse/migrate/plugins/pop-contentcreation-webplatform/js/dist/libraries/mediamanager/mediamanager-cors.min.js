"use strict";!function(e){window.popMediaManagerCORS={domains:{"editor-gallery":null,"editor-insert":null,featuredImage:null},documentInitializedIndependent:function(){var a=this;e(document).on("wp.ajax:send:options",function(e,t){a.setEditorOptions(t)}),e(document).on("uploader:start:settings",function(e,t){a.setUploadSettings(t)}),e(document).ready(function(e){e(document.body).on("click.add-media-button",".insert-media,.media-menu-item",function(e){var t=popMediaManager.getDomain(),n=wp.media.frame.state();["gallery","insert"].indexOf(n.id)>-1&&(t&&a.domains["editor-"+n.id]&&t!=a.domains["editor-"+n.id]&&(popMediaManager.needsRefresh["editor-"+n.id]=!0),a.domains["editor-"+n.id]=t)}),"undefined"!=typeof popFeaturedImage?a.initFeaturedImage():e(document).on("initialized.featuredImage",function(){a.initFeaturedImage()})})},initFeaturedImage:function(){var e=this;popFeaturedImage.getFrame().on("open",function(){var a=popMediaManager.getDomain();a&&e.domains.featuredImage&&a!=e.domains.featuredImage&&(popMediaManager.needsRefresh.featuredImage=!0),e.domains.featuredImage=a})},setEditorOptions:function(e){var a=popMediaManager.getDomain();if(a&&(a!=M.HOME_DOMAIN&&(e.url=a+M.AJAXURL,e.xhrFields={withCredentials:!0},e.crossDomain=!0),e.data&&e.data.action)){var t={"query-attachments":"media-form","save-attachment-compat":"media-form","save-attachment-order":"media-form","send-attachment-to-editor":"media-send-to-editor","send-link-to-editor":"media-send-to-editor"}[e.data.action];if(t){var n=popManager.getTopLevelFeedback(a)[M.URLPARAM_NONCES][t];e.data._wpnonce&&(e.data._wpnonce=n),e.data.nonce&&(e.data.nonce=n),e.data.query&&e.data.query._wpnonce&&(e.data.query._wpnonce=n),e.data.query&&e.data.query.nonce&&(e.data.query.nonce=n)}}},setUploadSettings:function(e){var a=popMediaManager.getDomain();if(a){e.url=a+M.UPLOADURL;var t={"upload-attachment":"media-form"}[e.multipart_params.action];t&&(e.multipart_params._wpnonce=popManager.getTopLevelFeedback(a)[M.URLPARAM_NONCES][t])}}}}(jQuery),popJSLibraryManager.register(popMediaManagerCORS,["documentInitializedIndependent"],!0);